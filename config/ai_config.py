"""
AI 配置文件
用于管理 Deepseek API 和 AI 报告生成相关配置
"""

import os

# ===== AI 功能开关 =====
ENABLE_REAL_AI = True  # 主开关:是否启用真实 AI API（设置为 True 启用）

# ===== Deepseek API 配置 =====
# 方法1: 使用环境变量（推荐）
DEEPSEEK_API_KEY = os.getenv("DEEPSEEK_API_KEY", "")  # 从环境变量读取 API Key

# 方法2: 直接在这里设置（不推荐，因为会提交到git）
# DEEPSEEK_API_KEY = ""  # 取消注释并替换为您的 API Key

DEEPSEEK_BASE_URL = "https://api.deepseek.com"  # Deepseek API 端点
AI_MODEL = "deepseek-reasoner"  # 默认模型

# ===== API 调用参数 =====
AI_MAX_TOKENS = 5000  # 最大生成 token 数
AI_TEMPERATURE = 1.0  # 温度参数（0-2，越高越随机）
AI_REQUEST_TIMEOUT = 60  # API 请求超时时间（秒）
AI_MAX_RETRIES = 3  # 最大重试次数

# ===== 报告缓存配置 =====
AI_REPORT_CACHE_ENABLED = True  # 是否启用报告缓存
AI_REPORT_CACHE_TTL = 3600  # 缓存有效期（秒），默认 1 小时

# ===== Prompt 模板 =====

# ===== System Prompt: 设定专家角色与分析逻辑 =====
AI_SYSTEM_PROMPT = """
你是一位精通小红书（Xiaohongshu）算法机制的**流量逆向工程师**，同时也是一位资深的**摄影美学顾问**。
你的任务不是给博主写鸡汤建议，而是通过数据**拆解其账号的成长逻辑**，并**推演背后的流量分发机制**。

在分析时，请遵循以下原则：
1. **流量归因**：区分流量是来自"搜索"（如器材测评、参数分享，长尾流量久）还是"推荐流"（如视觉冲击、情绪共鸣，爆发快）。
2. **关注"低粉爆文"**：特别关注那些点赞数远超粉丝数的笔记，这代表内容击中了算法。
3. **摄影垂直视角**：从标题中提取视觉关键词（如：胶片感、极简、扫街、人像、蓝调时刻），分析审美趋势。
4. **客观犀利**：直接指出其成功是靠运气、靠硬核技术、还是靠特定的人设包装。
"""

# ===== User Prompt: 注入数据与具体任务 =====
AI_USER_PROMPT_TEMPLATE = """
# 📸 摄影博主流量机制分析报告

## 1. 基础画像
- **昵称**: {nickname}
- **ID**: {user_id}
- **当前量级**: 粉丝 {fans:,} | 笔记 {total_notes} 篇
- **互动大盘**: 平均点赞 {avg_likes:.0f} | 平均收藏 {avg_collects:.0f} | 互动率 {interaction_rate:.2%} (互动/粉丝)
- **爆款强度**: 爆款率 {outlier_rate:.1%} (点赞 > 平均值3倍的笔记占比)

## 2. 爆款笔记样本 (Top {top_n})
*请仔细阅读以下高赞笔记的标题和数据，寻找共同点：*
{top_notes_info}

---

## 🕵️‍♂️ 深度分析任务 (请用 Markdown 输出)

### 1. 📈 成长路径与人设定位
*   **账号定位判定**：他是"器材党/参数党"（工具属性）、"审美/情绪博主"（观赏属性）还是"教程博主"（教育属性）？
*   **成长阶段判断**：根据数据表现，该账号处于冷启动期、爆发期还是瓶颈期？
*   **人设记忆点**：从爆款标题中，提取出他最吸引人的标签（例如："只会拍背影的摄影师"、"富士直出色彩大师"）。

### 2. 🧬 流量密码拆解 (核心机制分析)
*   **爆文基因**：分析 Top 笔记的共性。是靠**标题党**（如"千万别买..."），还是靠**特定场景**（如"雨天扫街"），或是**干货价值**（如"附参数设置"）？
*   **触达机制推演**：
    *   *搜索侧*：标题是否包含强搜索词（相机型号、地名、教程）？
    *   *推荐侧*：标题是否包含情绪词、争议点或强烈的视觉描述？
*   **低粉爆文特征**：如果有"赞粉比"极高（例如粉丝1000，点赞5000）的笔记，请重点分析它做对了什么？

### 3. 🎨 摄影垂直风格分析
*   **视觉关键词**：从标题中推断其照片风格（如：日系、赛博朋克、黑金、极简、胶片）。
*   **选题偏好**：他更倾向于拍人像、风光、街头还是静物？哪种选题的数据表现最好？

### 4. 🚀 策略复盘与建议
*   **如果我是这个博主**：基于数据，哪类内容应该**All-in**（加大投入），哪类内容应该**砍掉**？
*   **标题优化建议**：给出 3 个符合该博主风格但更具点击率的标题模版。

### 5. ⚠️ 总结：一句话流量结论
*   用一句话总结：这个博主能火/能涨粉的核心逻辑是什么？
"""
