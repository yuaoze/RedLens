# RedLens - å°çº¢ä¹¦æ‘„å½±åšä¸»åˆ†æå·¥å…·

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org)

RedLens æ˜¯ä¸€ä¸ªåŸºäº MediaCrawler çš„å°çº¢ä¹¦æ‘„å½±åšä¸»åˆ†æå·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–æŒ–æ˜åšä¸»ã€é‡‡é›†æ•°æ®ã€æ¸…æ´—å…¥åº“ï¼Œå¹¶è¿›è¡Œ AI æ´å¯Ÿåˆ†æã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æ™ºèƒ½å‘ç°**: é€šè¿‡å…³é”®è¯æœç´¢è‡ªåŠ¨å‘ç°ä¼˜è´¨æ‘„å½±åšä¸»
- ğŸ“¥ **æ•°æ®é‡‡é›†**: æ‰¹é‡é‡‡é›†åšä¸»çš„ç¬”è®°æ•°æ®å’Œäº’åŠ¨æŒ‡æ ‡
- ğŸ”¥ **çˆ†æ¬¾è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«é«˜äº’åŠ¨çš„ç—…æ¯’å¼å†…å®¹ï¼ˆçˆ†æ¬¾ï¼‰
- ğŸ“Š **å¯è§†åŒ–åˆ†æ**: äº¤äº’å¼ Streamlit ä»ªè¡¨æ¿å±•ç¤ºæ•°æ®æ´å¯Ÿ
- ğŸ¤– **AI æ´å¯Ÿ**: åŸºäº Claude AI ç”Ÿæˆåšä¸»å†…å®¹ç­–ç•¥å»ºè®®
- ğŸ’¾ **SQLite å­˜å‚¨**: è½»é‡çº§æ•°æ®åº“ï¼Œæ˜“äºéƒ¨ç½²å’Œç»´æŠ¤

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Core Engine**: MediaCrawlerï¼ˆå°çº¢ä¹¦æ•°æ®é‡‡é›†ï¼‰
- **Database**: SQLite
- **Visualization**: Streamlit + Plotly
- **AI Analysis**: Anthropic Claude API
- **Language**: Python 3.8+

## ğŸ“¦ å®‰è£…

### 1. å…‹éš†ä»“åº“

```bash
cd /path/to/MediaCrawler
# RedLens å·²ç»åŒ…å«åœ¨ red_lens/ ç›®å½•ä¸­
```

### 2. å®‰è£…ä¾èµ–

```bash
pip install streamlit plotly pandas requests
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
python red_lens/db.py
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: ä½¿ç”¨ Streamlit ç•Œé¢ï¼ˆæ¨èï¼‰

```bash
streamlit run red_lens/app.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:8501`

### æ–¹å¼ 2: ä½¿ç”¨å‘½ä»¤è¡Œ

#### Step 1: å‘ç°åšä¸»

```python
python -c "
from red_lens.discovery import search_and_extract_users
search_and_extract_users(['å¯Œå£«æ‰«è¡—', 'äººåƒæ‘„å½±', 'èƒ¶ç‰‡è‰²è°ƒ'], min_likes=200)
"
```

#### Step 2: é‡‡é›†æ•°æ®

```python
python -c "
from red_lens.pipeline import scrape_pending_bloggers
scrape_pending_bloggers(limit=5)
"
```

#### Step 3: åˆ†æçˆ†æ¬¾

```python
python -c "
from red_lens.analyzer import analyze_all_bloggers, download_outlier_covers
analyze_all_bloggers()
download_outlier_covers()
"
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. åšä¸»å‘ç°

åœ¨ Streamlit ä¾§è¾¹æ ä¸­ï¼š
1. è¾“å…¥æœç´¢å…³é”®è¯ï¼ˆé€—å·åˆ†éš”ï¼‰ï¼Œä¾‹å¦‚ï¼š`å¯Œå£«æ‰«è¡—,äººåƒæ‘„å½±,èƒ¶ç‰‡è‰²è°ƒ`
2. è®¾ç½®æœ€ä½ç‚¹èµæ•°è¿‡æ»¤é˜ˆå€¼ï¼ˆæ¨è 200+ï¼‰
3. ç‚¹å‡» "ğŸš€ å¼€å§‹å‘ç°åšä¸»"

ç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
- æœç´¢åŒ…å«è¿™äº›å…³é”®è¯çš„ç¬”è®°
- æå–ç‚¹èµæ•°è¶…è¿‡é˜ˆå€¼çš„åšä¸»
- ä¿å­˜åˆ°æ•°æ®åº“ï¼ŒçŠ¶æ€è®¾ä¸º `pending`

### 2. æ•°æ®é‡‡é›†

åœ¨ä¾§è¾¹æ ä¸­ï¼š
1. è®¾ç½®æ¯æ¬¡é‡‡é›†çš„åšä¸»æ•°é‡ï¼ˆå»ºè®® 5 ä½ï¼‰
2. ç‚¹å‡» "ğŸ“Š å¼€å§‹é‡‡é›†æ•°æ®"

ç³»ç»Ÿä¼šï¼š
- ä»æ•°æ®åº“è¯»å– `pending` çŠ¶æ€çš„åšä¸»
- é‡‡é›†æ¯ä½åšä¸»çš„æ‰€æœ‰ç¬”è®°æ•°æ®
- æ¸…æ´—å¹¶å­˜å…¥ `notes` è¡¨
- æ›´æ–°åšä¸»çŠ¶æ€ä¸º `scraped`
- éšæœºå»¶è¿Ÿ 10-30 ç§’ï¼ˆé˜²é£æ§ï¼‰

### 3. çˆ†æ¬¾åˆ†æ

ç‚¹å‡» "ğŸ”¥ è¯†åˆ«æ‰€æœ‰çˆ†æ¬¾"ï¼š
- è®¡ç®—æ¯ä½åšä¸»çš„å¹³å‡ç‚¹èµæ•°
- æ ‡è®°ç‚¹èµæ•° > 3x å¹³å‡å€¼ ä¸” > 500 çš„ç¬”è®°ä¸ºçˆ†æ¬¾
- åœ¨æ•°æ®åº“ä¸­è®¾ç½® `is_outlier=True`

ç‚¹å‡» "ğŸ“¥ ä¸‹è½½çˆ†æ¬¾å°é¢"ï¼š
- ä¸‹è½½æ‰€æœ‰çˆ†æ¬¾ç¬”è®°çš„å°é¢å›¾
- ä¿å­˜åˆ° `red_lens/assets/covers/`
- æ›´æ–°æ•°æ®åº“ä¸­çš„æœ¬åœ°è·¯å¾„

### 4. æŸ¥çœ‹åˆ†æç»“æœ

#### ğŸ“Š åšä¸»æ’è¡Œæ¦œ

- å±•ç¤ºæ‰€æœ‰å·²é‡‡é›†åšä¸»
- æŒ‰çˆ†æ¬¾ç‡æ’åº
- å¯è§†åŒ–å¯¹æ¯”ï¼š
  - Top 10 åšä¸»çˆ†æ¬¾ç‡
  - Top 10 åšä¸»å¹³å‡ç‚¹èµ
  - ç¬”è®°æ•°é‡ vs çˆ†æ¬¾ç‡æ•£ç‚¹å›¾

#### ğŸ”¥ çˆ†æ¬¾ç”»å»Š

- ç€‘å¸ƒæµå±•ç¤ºæ‰€æœ‰çˆ†æ¬¾å†…å®¹
- æ”¯æŒç­›é€‰ï¼šæœ€ä½ç‚¹èµæ•°ã€æŒ‡å®šåšä¸»
- æ˜¾ç¤ºå°é¢å›¾ã€äº’åŠ¨æ•°æ®ã€å‘å¸ƒæ—¶é—´

#### ğŸ“ˆ è¯¦ç»†åˆ†æ

é€‰æ‹©ç‰¹å®šåšä¸»æŸ¥çœ‹ï¼š
- æ•°æ®æ¦‚è§ˆï¼ˆç¬”è®°æ•°ã€å¹³å‡ç‚¹èµã€çˆ†æ¬¾ç‡ç­‰ï¼‰
- å†…å®¹åˆ†å¸ƒï¼ˆå›¾æ–‡ vs è§†é¢‘ã€çˆ†æ¬¾ vs æ™®é€šï¼‰
- ç‚¹èµæ•°æ—¶é—´è¶‹åŠ¿å›¾
- Top 10 çƒ­é—¨ç¬”è®°åˆ—è¡¨
- ğŸ¤– AI æ´å¯ŸæŠ¥å‘Šï¼ˆç‚¹å‡»ç”Ÿæˆï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
red_lens/
â”œâ”€â”€ __init__.py          # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ db.py                # æ•°æ®åº“æ¨¡å—ï¼ˆSQLiteï¼‰
â”œâ”€â”€ discovery.py         # åšä¸»å‘ç°æ¨¡å—
â”œâ”€â”€ pipeline.py          # æ•°æ®é‡‡é›†ä¸æ¸…æ´—
â”œâ”€â”€ analyzer.py          # çˆ†æ¬¾åˆ†æä¸ AI æ´å¯Ÿ
â”œâ”€â”€ app.py               # Streamlit å¯è§†åŒ–ç•Œé¢
â”œâ”€â”€ red_lens.db          # SQLite æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ covers/          # çˆ†æ¬¾å°é¢å›¾å­˜å‚¨ç›®å½•
â””â”€â”€ README.md            # æœ¬æ–‡æ¡£
```

## ğŸ—ƒï¸ æ•°æ®åº“æ¶æ„

### bloggers è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| user_id | TEXT (PK) | ç”¨æˆ· ID |
| nickname | TEXT | æ˜µç§° |
| avatar_url | TEXT | å¤´åƒ URL |
| initial_fans | INTEGER | å…¥åº“æ—¶ç²‰ä¸æ•° |
| current_fans | INTEGER | æœ€æ–°ç²‰ä¸æ•° |
| source_keyword | TEXT | æ¥æºå…³é”®è¯ |
| status | TEXT | çŠ¶æ€ (pending/scraped/error) |
| last_update | TIMESTAMP | æœ€åæ›´æ–°æ—¶é—´ |

### notes è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| note_id | TEXT (PK) | ç¬”è®° ID |
| user_id | TEXT (FK) | ç”¨æˆ· ID |
| title | TEXT | æ ‡é¢˜ |
| desc | TEXT | æè¿° |
| type | TEXT | ç±»å‹ (video/image) |
| likes | INTEGER | ç‚¹èµæ•° |
| collects | INTEGER | æ”¶è—æ•° |
| comments | INTEGER | è¯„è®ºæ•° |
| create_time | TIMESTAMP | å‘å¸ƒæ—¶é—´ |
| crawled_time | TIMESTAMP | çˆ¬å–æ—¶é—´ |
| cover_url | TEXT | å°é¢ URL |
| local_cover_path | TEXT | æœ¬åœ°å°é¢è·¯å¾„ |
| is_outlier | BOOLEAN | æ˜¯å¦ä¸ºçˆ†æ¬¾ |

## ğŸ”¬ çˆ†æ¬¾ç®—æ³•

ä¸€ç¯‡ç¬”è®°è¢«æ ‡è®°ä¸ºçˆ†æ¬¾éœ€æ»¡è¶³ï¼š
1. `likes > avg_likes Ã— 3` (ç‚¹èµæ•°è¶…è¿‡è¯¥åšä¸»å¹³å‡å€¼çš„ 3 å€)
2. `likes > 500` (ç»å¯¹ç‚¹èµæ•°è¶…è¿‡ 500)

å¯åœ¨ `analyzer.py` ä¸­è°ƒæ•´å‚æ•°ï¼š
```python
identify_outliers(user_id, multiplier=3.0, min_likes=500)
```

## ğŸ¤– AI æ´å¯Ÿ

ç›®å‰ä½¿ç”¨ Mock æŠ¥å‘Šã€‚å¦‚éœ€æ¥å…¥çœŸå® Claude APIï¼š

1. å®‰è£… Anthropic SDKï¼š
```bash
pip install anthropic
```

2. è®¾ç½® API Keyï¼š
```bash
export ANTHROPIC_API_KEY="your-api-key"
```

3. ä¿®æ”¹ `analyzer.py` ä¸­çš„ `generate_ai_report()` å‡½æ•°ï¼Œå°† `use_mock=False`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éµå®ˆå¹³å°è§„åˆ™**: æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·éµå®ˆå°çº¢ä¹¦ä½¿ç”¨æ¡æ¬¾
2. **è¯·æ±‚é¢‘ç‡æ§åˆ¶**: é‡‡é›†æ—¶è‡ªåŠ¨æ·»åŠ  10-30 ç§’éšæœºå»¶è¿Ÿ
3. **æ•°æ®å­˜å‚¨**: æ•°æ®åº“æ–‡ä»¶åœ¨ `red_lens/red_lens.db`ï¼Œè¯·å®šæœŸå¤‡ä»½
4. **MediaCrawler ä¾èµ–**: éœ€è¦å…ˆè¿è¡Œ MediaCrawler è¿›è¡Œåˆå§‹æ•°æ®é‡‡é›†

## ğŸ“ å¼€å‘è®¡åˆ’

- [ ] æ”¯æŒå®æ—¶è¿è¡Œ MediaCrawlerï¼ˆå½“å‰éœ€è¦æ‰‹åŠ¨è¿è¡Œï¼‰
- [ ] æ¥å…¥çœŸå® Claude API è¿›è¡Œ AI åˆ†æ
- [ ] æ”¯æŒæ›´å¤šå¹³å°ï¼ˆæŠ–éŸ³ã€Bç«™ç­‰ï¼‰
- [ ] å¯¼å‡ºåˆ†ææŠ¥å‘Šï¼ˆPDF/Excelï¼‰
- [ ] ç²‰ä¸å¢é•¿è¿½è¸ª
- [ ] å†…å®¹æ ‡ç­¾äº‘åˆ†æ

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MediaCrawler å¼€å‘ï¼Œç»§æ‰¿å…¶éå•†ä¸šå­¦ä¹ è®¸å¯è¯ã€‚ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ã€‚

## ğŸ™ è‡´è°¢

- [MediaCrawler](https://github.com/NanmiCoder/MediaCrawler) - æä¾›æ ¸å¿ƒçˆ¬è™«å¼•æ“
- [Streamlit](https://streamlit.io/) - æä¾›å¯è§†åŒ–æ¡†æ¶
- [Anthropic Claude](https://www.anthropic.com/) - AI åˆ†æèƒ½åŠ›

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issueã€‚

---

**Happy Analyzing! ğŸ“¸âœ¨**
